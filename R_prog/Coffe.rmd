# Packages

```{r}
package <- c("readxl","tidyverse","ggplot2","dplyr")
lapply(package, library, character.only = TRUE)
#lapply(package, install.packages, character.only = TRUE) # uncomment this to hellp in installtion oacpackages in one swoop
```


# Data importation

```{r}
coffee <- read_excel("~/Data/coffee_shop_survey.xlsx")
head(coffee)
summary(coffee)
```

# üìä Descriptive Analysis Questions

## What is the average age of customers visiting the coffee shop?

```{r}
mean(coffee$Age)

```


## What is the gender distribution among respondents?

```{r}
table(coffee$Gender)
```


## What are the most and least popular products?

```{r}
coffee %>%
  group_by(Favorite_Product) %>%
  summarise(count = n()) %>%
  arrange(desc(count))
```


# üìà Relationship & Comparison Questions

## Does visit frequency differ by gender or age group?

```{r}
coffee %>%
  group_by(Gender) %>%
  summarise(visit_mean = mean(Visit_Frequency),
            count = n())

ggplot(coffee, aes(x = Age, y = Visit_Frequency, fill = Gender)) +
  geom_boxplot() +
  labs(title = "Visit Frequency by Age Group and Gender")
```

## Is there a relationship between visit frequency and satisfaction score?

```{r}
coffee %>%
  select(Satisfaction_Score,Visit_Frequency) %>%
  group_by(Satisfaction_Score) %>%
  summarise(count = n(),visit_mean = mean(Visit_Frequency))

# chi square test 

table_data <- table(coffee$Visit_Frequency, coffee$Satisfaction_Score)
chisq.test(table_data)
```



## Do loyalty members spend more time at the coffee shop than non-members?

```{r}
colnames(coffee)
coffee %>%
  group_by(Loyalty_Member) %>%
  summarise(count = n(), meantime = mean(`Time_Spent (min)`))

t.test(`Time_Spent (min)` ~ Loyalty_Member, data = coffee)

```


## Are customers who would recommend the coffee shop more likely to be loyal members?

```{r}
coffee %>%
  group_by(Loyalty_Member,Would_Recommend) %>%
  count(Loyalty_Member,Would_Recommend)

# Remove rows with NA in either Recommend or Loyalty_Member
cleaned_data <- coffee %>%
  filter(!is.na(Would_Recommend), !is.na(Loyalty_Member))

# Create the contingency table
table_data <- table(cleaned_data$Would_Recommend, cleaned_data$Loyalty_Member)

# Run the chi-squared test
chisq.test(table_data)

```




# üß† Insightful/Advanced Questions

## What factors (age, loyalty status, product preference) are associated with higher satisfaction scores?

```{r}
library("MASS")

# Fit the model using polr() from the MASS package
model <- MASS::polr(as.factor(Satisfaction_Score) ~ Age + Loyalty_Member + Favorite_Product, data = coffee, Hess = TRUE)

# Summary of model
summary(model)

```


## Is there a difference in satisfaction scores between customers who prefer coffee and those who prefer pastries?



```{r}
unique(coffee$Favorite_Product)
coffee_filtered <- coffee %>%
  filter(Favorite_Product %in% c("Coffee", "Pastry"))

t.test(Satisfaction_Score ~ Favorite_Product, data = coffee_filtered)

  
```



Can we predict whether a customer would recommend the coffee shop based on other variables?

üîÅ Time-Specific (if you want to expand the dataset)
Do visit patterns vary depending on the time of day or day of the week?

Is there any seasonality in satisfaction levels?